<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Kizzez - Admin</title>
    <link rel="icon" href="/img/logos/logo_Kizzez02.png" />
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- CSS -->
    <link rel="stylesheet" href="/CSS/styleAdmin.css">
</head>
<body>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- JS -->
    <script src="/JS/scriptAdmin.js" defer></script>

    <!-- Header -->
    <header class="admin-header">
        <div class="container d-flex justify-content-between align-items-center">
        <div>
            <h1 class="h4 mb-0 text-gold">KIZZEZ — Panel Administrador</h1>
            <small class="text-white-50">Gestión rápida de productos, pedidos y contenido</small>
        </div>
        <div class="d-flex gap-2">
            <button id="back-to-site" class="btn btn-outline-light" aria-label="Ver sitio público"><i class="bi bi-arrow-left me-1"></i> Ver web pública</button>
            <button id="btn-logout" class="btn btn-outline-light" aria-label="Cerrar sesión"><i class="bi bi-box-arrow-right me-1"></i> Cerrar sesión</button>
        </div>
        </div>
    </header>

    <!-- Main -->
    <main class="container my-4">
        <div class="row g-3">
        <!-- SIDEBAR -->
        <aside class="col-lg-3">
            <div class="admin-sidebar" role="navigation" aria-label="Panel lateral">
            <div class="d-flex align-items-center mb-3">
                <i class="bi bi-person-circle fs-1 text-gold me-3" aria-hidden="true"></i>
                <div>
                <div class="fw-bold">Administrador</div>
                <div class="small text-white-50">admin@kizzez.com</div>
                </div>
            </div>

            <nav class="d-grid" id="admin-nav">
                <a href="#" class="btn btn-sm btn-transparent text-start text-white admin-nav active" data-section="dashboard"><i class="bi bi-speedometer2 me-2"></i> Dashboard</a>
                <a href="#" class="btn btn-sm btn-transparent text-start text-white admin-nav" data-section="products"><i class="bi bi-cup-hot me-2"></i> Productos</a>
                <a href="#" class="btn btn-sm btn-transparent text-start text-white admin-nav" data-section="orders"><i class="bi bi-cart-check me-2"></i> Pedidos</a>
                <a href="#" class="btn btn-sm btn-transparent text-start text-white admin-nav" data-section="content"><i class="bi bi-file-text me-2"></i> Contenido</a>
                <a href="#" class="btn btn-sm btn-transparent text-start text-white admin-nav" data-section="coupons"><i class="bi bi-ticket-perforated me-2"></i> Cupones</a>
                <a href="#" class="btn btn-sm btn-transparent text-start text-white admin-nav" data-section="activity"><i class="bi bi-clock-history me-2"></i> Actividad</a>
                <a href="#" class="btn btn-sm btn-transparent text-start text-danger mt-2" id="btn-logout-side"><i class="bi bi-box-arrow-right me-2"></i> Cerrar sesión</a>
            </nav>

            <hr class="border-white-10 my-3">

            <div class="mb-2 small text-white-50">Acciones rápidas</div>
            <div class="d-flex gap-2 flex-wrap">
                <button class="btn btn-sm btn-warning" id="quickAddProduct"><i class="bi bi-plus-lg me-1"></i> Nuevo producto</button>
                <button class="btn btn-sm btn-outline-light" id="exportCsvBtn"><i class="bi bi-file-earmark-arrow-down me-1"></i> Exportar</button>
            </div>
            </div>
        </aside>

        <!-- CONTENT -->
        <section class="col-lg-9">
            <!-- Dashboard -->
            <div id="dashboard" class="admin-content section active" aria-live="polite">
            <div class="d-flex justify-content-between align-items-start mb-3">
                <div>
                <h2 class="h5 text-gold mb-1">Resumen</h2>
                <p class="small-muted mb-0">Visión general rápida del negocio</p>
                </div>
                <div class="d-flex gap-2">
                <button class="btn btn-sm btn-outline-secondary" id="refreshDataBtn" aria-label="Actualizar datos"><i class="bi bi-arrow-clockwise"></i></button>
                </div>
            </div>

            <div class="row g-3 mb-3">
                <div class="col-sm-6 col-md-3">
                <div class="admin-stats-card">
                    <div class="small-muted">Pedidos totales</div>
                    <div class="h3 admin-stats-number" id="stat-orders">0</div>
                    <div class="small-muted">Hoy: <span id="stat-orders-today">0</span></div>
                </div>
                </div>
                <div class="col-sm-6 col-md-3">
                <div class="admin-stats-card">
                    <div class="small-muted">Ingresos estimados</div>
                    <div class="h3 admin-stats-number" id="stat-revenue">S/ 0.00</div>
                    <div class="small-muted">Promedio: <span id="stat-avg">S/ 0.00</span></div>
                </div>
                </div>
                <div class="col-sm-6 col-md-3">
                <div class="admin-stats-card">
                    <div class="small-muted">Productos</div>
                    <div class="h3 admin-stats-number" id="stat-products">0</div>
                    <div class="small-muted">Stock total: <span id="stat-stock">0</span></div>
                </div>
                </div>
                <div class="col-sm-6 col-md-3">
                <div class="admin-stats-card">
                    <div class="small-muted">Satisfacción</div>
                    <div class="h3 admin-stats-number" id="stat-sat">—</div>
                    <div class="small-muted">Basado en pedidos</div>
                </div>
                </div>
            </div>

            <div class="row g-3">
                <div class="col-lg-8">
                <div class="mb-3">
                    <h3 class="h6 text-gold">Ventas por producto</h3>
                    <div id="salesChartWrapper">
                    <canvas id="salesChart" height="200" aria-label="Gráfico de ventas"></canvas>
                    <div id="salesChartFallback" class="chart-fallback visually-hidden">No hay datos de ventas disponibles</div>
                    </div>
                </div>
                <div>
                    <h3 class="h6 text-gold mb-2">Pedidos recientes</h3>
                    <div class="table-responsive">
                    <table class="table align-middle">
                        <thead>
                        <tr class="admin-table">
                            <th scope="col">#</th><th scope="col">Cliente</th><th scope="col">Total</th><th scope="col">Estado</th><th scope="col">Fecha</th>
                        </tr>
                        </thead>
                        <tbody id="dashboard-recent-orders"></tbody>
                    </table>
                    </div>
                </div>
                </div>

                <div class="col-lg-4">
                <div class="mb-3">
                    <h3 class="h6 text-gold">Alertas</h3>
                    <ul class="list-unstyled" id="alertsList"></ul>
                </div>

                <div>
                    <h3 class="h6 text-gold">Actividad reciente</h3>
                    <div id="activityFeed" style="max-height:320px; overflow:auto;"></div>
                </div>
                </div>
            </div>
            </div>

            <!-- PRODUCTS -->
            <div id="products" class="admin-content section">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <div>
                <h2 class="h5 text-gold mb-0">Gestión de Productos</h2>
                <small class="small-muted">Agregar, editar, buscar y exportar productos</small>
                </div>
                <div class="d-flex gap-2">
                <input id="searchInput" class="form-control form-control-sm" placeholder="Buscar producto..." style="min-width:220px;" aria-label="Buscar producto">
                <select id="filterCategory" class="form-select form-select-sm" aria-label="Filtrar por categoría">
                    <option value="">Todas las categorías</option>
                    <option value="bebidas-calientes">Bebidas Calientes</option>
                    <option value="bebidas-frias">Bebidas Frías</option>
                    <option value="postres">Postres</option>
                    <option value="sandwiches">Sandwiches</option>
                </select>
                <select id="filterStatus" class="form-select form-select-sm" aria-label="Filtrar por estado">
                    <option value="">Todos</option>
                    <option value="active">Activo</option>
                    <option value="inactive">Inactivo</option>
                </select>
                <button class="btn btn-sm btn-warning" data-bs-toggle="modal" data-bs-target="#productModal" id="openAddBtn"><i class="bi bi-plus-lg me-1"></i> Nuevo</button>
                </div>
            </div>

            <div class="table-responsive">
                <table class="table align-middle">
                <thead>
                    <tr class="admin-table">
                    <th scope="col">Imagen</th>
                    <th scope="col">Nombre</th>
                    <th scope="col">Categoría</th>
                    <th scope="col">Precio</th>
                    <th scope="col">Stock</th>
                    <th scope="col">Estado</th>
                    <th scope="col"></th>
                    </tr>
                </thead>
                <tbody id="products-table-body"></tbody>
                </table>
            </div>
            </div>

            <!-- ORDERS -->
            <div id="orders" class="admin-content section">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <div>
                <h2 class="h5 text-gold mb-0">Pedidos</h2>
                <small class="small-muted">Ver, filtrar y actualizar estados</small>
                </div>
                <div>
                <select id="ordersFilter" class="form-select form-select-sm" aria-label="Filtrar pedidos">
                    <option value="">Todos</option>
                    <option value="pending">Pendiente</option>
                    <option value="preparing">Preparando</option>
                    <option value="on_way">En camino</option>
                    <option value="completed">Completado</option>
                </select>
                </div>
            </div>

            <div class="table-responsive">
                <table class="table align-middle">
                <thead>
                    <tr class="admin-table">
                    <th scope="col"># Pedido</th><th scope="col">Cliente</th><th scope="col">Items</th><th scope="col">Total</th><th scope="col">Estado</th><th scope="col">Acciones</th>
                    </tr>
                </thead>
                <tbody id="orders-table-body"></tbody>
                </table>
            </div>
            </div>

            <!-- CONTENT -->
            <div id="content" class="admin-content section">
            <h2 class="h5 text-gold mb-3">Contenido del sitio</h2>

            <div class="row g-3">
                <div class="col-md-6">
                <div class="card p-3">
                    <h6 class="mb-2">Slider principal</h6>
                    <form id="sliderForm">
                    <div class="mb-2">
                        <label class="form-label small">Título</label>
                        <input class="form-control form-control-sm" id="sliderTitle" value="Café que inspira">
                    </div>
                    <div class="mb-2">
                        <label class="form-label small">Descripción</label>
                        <textarea id="sliderDesc" class="form-control form-control-sm" rows="2">Sabores artesanales, ambiente cálido y entrega en todo Lima.</textarea>
                    </div>
                    <button type="submit" class="btn btn-sm btn-warning">Guardar</button>
                    </form>
                </div>
                </div>

                <div class="col-md-6">
                <div class="card p-3">
                    <h6 class="mb-2">Información de contacto</h6>
                    <form id="contactForm">
                    <div class="mb-2">
                        <label class="form-label small">Teléfono</label>
                        <input class="form-control form-control-sm" id="contactPhone" value="+51 954 651 321">
                    </div>
                    <div class="mb-2">
                        <label class="form-label small">Dirección</label>
                        <input class="form-control form-control-sm" id="contactAddress" value="Av. Principal 123, Los Olivos - Lima">
                    </div>
                    <button type="submit" class="btn btn-sm btn-warning">Guardar</button>
                    </form>
                </div>
                </div>
            </div>
            </div>

            <!-- COUPONS -->
            <div id="coupons" class="admin-content section">
            <h2 class="h5 text-gold mb-3">Cupones y Promociones</h2>
            <div class="mb-3">
                <button class="btn btn-sm btn-warning" id="createCouponBtn"><i class="bi bi-plus-lg me-1"></i> Crear cupón</button>
            </div>
            <div class="table-responsive">
                <table class="table align-middle">
                <thead>
                    <tr class="admin-table"><th>Código</th><th>Descuento</th><th>Válido hasta</th><th>Acciones</th></tr>
                </thead>
                <tbody id="couponsBody"></tbody>
                </table>
            </div>
            </div>

            <!-- ACTIVITY -->
            <div id="activity" class="admin-content section">
            <h2 class="h5 text-gold mb-3">Registro de actividad</h2>
            <div id="activityLog" style="max-height:420px; overflow:auto;"></div>
            <div class="mt-3">
                <button id="clearActivityBtn" class="btn btn-sm btn-outline-danger">Limpiar registro</button>
            </div>
            </div>

        </section>
        </div>
    </main>

    <!-- PRODUCT MODAL (Add/Edit) -->
    <div class="modal fade" id="productModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <form id="productForm">
            <div class="modal-header">
                <h5 class="modal-title text-gold" id="productModalTitle">Nuevo producto</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="productId">
                <div class="row g-3">
                <div class="col-md-6">
                    <label class="form-label">Nombre <span class="text-danger">*</span></label>
                    <input id="productName" required class="form-control">
                    <label class="form-label mt-2">Descripción</label>
                    <textarea id="productDesc" rows="3" class="form-control"></textarea>
                </div>
                <div class="col-md-6">
                    <label class="form-label">Precio (S/) <span class="text-danger">*</span></label>
                    <input id="productPrice" type="number" step="0.01" min="0" required class="form-control">
                    <label class="form-label mt-2">Categoría</label>
                    <select id="productCategory" class="form-select">
                    <option value="bebidas-calientes">Bebidas Calientes</option>
                    <option value="bebidas-frias">Bebidas Frías</option>
                    <option value="postres">Postres</option>
                    <option value="sandwiches">Sandwiches</option>
                    </select>
                    <label class="form-label mt-2">Stock <span class="text-danger">*</span></label>
                    <input id="productStock" type="number" min="0" required class="form-control">
                    <label class="form-label mt-2">Imagen (URL)</label>
                    <input id="productImage" class="form-control" placeholder="opcional: URL de imagen">
                    <div class="form-check form-switch mt-2">
                    <input class="form-check-input" type="checkbox" id="productActive" checked>
                    <label class="form-check-label">Activo</label>
                    </div>
                </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="submit" class="btn btn-warning" id="productSaveBtn">Guardar</button>
            </div>
            </form>
        </div>
        </div>
    </div>

    <!-- VIEW MODAL (simple) -->
    <div class="modal fade" id="viewModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-md modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title text-gold" id="viewModalTitle">Detalle</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body" id="viewModalBody"></div>
            <div class="modal-footer">
            <button class="btn btn-sm btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
        </div>
    </div>

    <!-- COUPON MODAL -->
    <div class="modal fade" id="couponModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
        <div class="modal-content">
            <form id="couponForm">
            <div class="modal-header">
                <h5 class="modal-title text-gold">Crear cupón</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body">
                <label class="form-label">Código <span class="text-danger">*</span></label>
                <input id="couponCode" class="form-control" required>
                <label class="form-label mt-2">Descuento (%) <span class="text-danger">*</span></label>
                <input id="couponDiscount" type="number" min="1" max="100" class="form-control" required>
                <label class="form-label mt-2">Válido hasta <span class="text-danger">*</span></label>
                <input id="couponExpiry" type="date" class="form-control" required>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Cancelar</button>
                <button class="btn btn-warning" type="submit">Crear</button>
            </div>
            </form>
        </div>
        </div>
    </div>

    <!-- Toasts -->
    <div class="toast-container" id="toastContainer" aria-live="polite" aria-atomic="true"></div>
</body>
</html>